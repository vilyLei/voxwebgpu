(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["ModuleDracoGeomParser"]=t():e["ModuleDracoGeomParser"]=t()})("undefined"!==typeof self?self:this,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="fae3")}({"1eb2":function(e,t,r){"use strict";if("undefined"!==typeof window){var n=window.document.currentScript,i=r("8875");n=i(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:i});var s=n&&n.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);s&&(r.p=s[1])}},"2e55":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{}n.PARSE="DRACO_PARSE",n.ENCODE="DRACO_ENCODE",n.THREAD_ACQUIRE_DATA="DRACO_THREAD_ACQUIRE_DATA",n.THREAD_TRANSMIT_DATA="DRACO_THREAD_TRANSMIT_DATA",t.DracoTaskCMD=n},"56b4":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("2e55");let i=n.DracoTaskCMD;const s=1;class o{constructor(){this.attMap=null,this.attOpts=null,this.parser=null,this.verbosity=1,this.drawMode=0,this.vsScale=1,this.attNSMap={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD",generic:"GENERIC"}}getAttributeOptions(e){return"undefined"===typeof this.attOpts[e]&&(this.attOpts[e]={}),this.attOpts[e]}addAttributeToGeometry(e,t,r,n,i,s){if(0===i.ptr){let e="DracoGeomParser: No attribute "+n;throw new Error(e)}let o=i.num_components(),a=new e.DracoFloat32Array;t.GetAttributeFloatForAllPoints(r,i,a);let u=r.num_points(),c=u*o,d=new Float32Array(c);for(let l=0;l<c;l++)d[l]=a.GetValue(l);s[n]=d,e.destroy(a)}decodeGeomData(e,t,r,n){let i,o,a;if(!0===this.getAttributeOptions("position").skipDequantization&&t.SkipAttributeTransform(e.POSITION),r===e.TRIANGULAR_MESH?(i=new e.Mesh,o=t.DecodeBufferToMesh(n,i)):(i=new e.PointCloud,o=t.DecodeBufferToPointCloud(n,i)),!o.ok()||0==i.ptr){let r="DracoGeomParser: Decoding failed: ";throw r+=o.error_msg(),e.destroy(t),e.destroy(i),new Error(r)}e.destroy(n),a=r==e.TRIANGULAR_MESH?i.num_faces():0;let u=t.GetAttributeId(i,e.POSITION);if(-1==u){let r="DracoGeomParser: No position attribute found.";throw e.destroy(t),e.destroy(i),new Error(r)}let c={};for(let s in this.attNSMap)if(void 0===this.attMap[s]){let r=t.GetAttributeId(i,e[this.attNSMap[s]]);if(-1!==r){this.verbosity;let n=t.GetAttribute(i,r);this.addAttributeToGeometry(e,t,i,s,n,c)}}for(let s in this.attMap){let r=this.attMap[s],n=t.GetAttributeByUniqueId(i,r);this.addAttributeToGeometry(e,t,i,s,n,c)}if(r==e.TRIANGULAR_MESH)if(this.drawMode===s){let t=new e.DracoInt32Array,r=t.size();c.indices=new Uint32Array(r);for(let e=0;e<r;++e)c.indices[e]=t.GetValue(e);e.destroy(t)}else{let r=3*a;c.indices=new Uint32Array(r);let n=new e.DracoInt32Array;for(let e=0;e<a;++e){t.GetFaceFromMesh(i,e,n);const r=3*e;c.indices[r]=n.GetValue(0),c.indices[r+1]=n.GetValue(1),c.indices[r+2]=n.GetValue(2)}e.destroy(n)}return r!=e.TRIANGULAR_MESH&&(c.indices=null),e.destroy(t),e.destroy(i),c}parseData(e,t,r,n){let i=this.parser,s=new i.DecoderBuffer,o=r-t;n<1?s.Init(new Int8Array(e.buffer).subarray(0,o),o):s.Init(new Int8Array(e.buffer).subarray(t,r),o);let a=new i.Decoder,u=a.GetEncodedGeometryType(s);if(u==i.TRIANGULAR_MESH)this.verbosity;else{if(u!=i.POINT_CLOUD){let e="DracoGeomParser: Unknown geometry type.";throw new Error(e)}this.verbosity}return this.decodeGeomData(i,a,u,s)}getParseData(e,t){let r=null;if(null!=e){r=[];for(let t in e)null!=e[t]&&r.push(e[t].buffer)}let n={vertices:e.position,uvsList:null,normals:null,indices:null};return void 0!=e.indices&&(n.indices=e.indices),void 0!=e.normal&&(n.normals=e.normal),void 0!=e.uv&&(n.uvsList=[e.uv]),{data:n,transfers:r,errorFlag:t}}receiveCall(e){let t=e.streams;this.drawMode=0,this.vsScale=1,this.attMap={},this.attOpts={position:{}};let r=0,n=null;if(null!=t){let s=e.descriptor;if(s.endI>s.beginI){let e=t[0];try{Date.now();n=this.parseData(e,s.beginI,s.endI,s.status)}catch(i){r=-1,n=null}}}else r=-2;return this.getParseData(n,r)}}class a{constructor(){this.m_dependencyFinish=!1,this.m_wasmData=null,this.m_currTaskClass=-1,this.threadIndex=0,this.parser=null,this.decoder={wasmBinary:null},this.dracoParser=new o,this.m_currTaskClass=ThreadCore.getCurrTaskClass(),ThreadCore.setCurrTaskClass(this.m_currTaskClass),ThreadCore.acquireData(this,{},i.THREAD_ACQUIRE_DATA),ThreadCore.useDependency(this),ThreadCore.resetCurrTaskClass()}initDecoder(e){let t=e.streams[0];this.decoder["wasmBinary"]=t,this.decoder["onModuleLoaded"]=r=>{this.parser=r,this.dracoParser.parser=r,ThreadCore.setCurrTaskClass(this.m_currTaskClass),ThreadCore.transmitData(this,e,i.THREAD_TRANSMIT_DATA,[t]),ThreadCore.initializeExternModule(this),ThreadCore.resetCurrTaskClass()},DracoDecoderModule(this.decoder)}receiveData(e){switch(e.taskCmd){case i.PARSE:let t=this.dracoParser.receiveCall(e);e.data={model:t.data,errorFlag:t.errorFlag},ThreadCore.postMessageToThread(e,t.transfers);break;case i.THREAD_ACQUIRE_DATA:this.threadIndex=e.threadIndex,this.m_wasmData=e.data,this.m_dependencyFinish&&null!=this.m_wasmData&&this.initDecoder(this.m_wasmData);break;default:break}}getUniqueName(){return"dracoGeomParser"}dependencyFinish(){this.m_dependencyFinish=!0,this.m_dependencyFinish&&null!=this.m_wasmData&&this.initDecoder(this.m_wasmData)}}t.DracoGeomParseTask=a;new a},8875:function(e,t,r){var n,i,s;(function(r,o){i=[],n=o,s="function"===typeof n?n.apply(t,i):n,void 0===s||(e.exports=s)})("undefined"!==typeof self&&self,(function(){function e(){var t=Object.getOwnPropertyDescriptor(document,"currentScript");if(!t&&"currentScript"in document&&document.currentScript)return document.currentScript;if(t&&t.get!==e&&document.currentScript)return document.currentScript;try{throw new Error}catch(h){var r,n,i,s=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,o=/@([^@]*):(\d+):(\d+)\s*$/gi,a=s.exec(h.stack)||o.exec(h.stack),u=a&&a[1]||!1,c=a&&a[2]||!1,d=document.location.href.replace(document.location.hash,""),l=document.getElementsByTagName("script");u===d&&(r=document.documentElement.outerHTML,n=new RegExp("(?:[^\\n]+?\\n){0,"+(c-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),i=r.replace(n,"$1").trim());for(var f=0;f<l.length;f++){if("interactive"===l[f].readyState)return l[f];if(l[f].src===u)return l[f];if(u===d&&l[f].innerHTML&&l[f].innerHTML.trim()===i)return l[f]}return null}}return e}))},fae3:function(e,t,r){"use strict";r.r(t);r("1eb2");var n=r("56b4");for(var i in n)["default"].indexOf(i)<0&&function(e){r.d(t,e,(function(){return n[e]}))}(i)}})}));