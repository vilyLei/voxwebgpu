(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["ModuleOBJGeomParser"]=t():e["ModuleOBJGeomParser"]=t()})("undefined"!==typeof self?self:this,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="fae3")}({"1eb2":function(e,t,r){"use strict";if("undefined"!==typeof window){var n=window.document.currentScript,s=r("8875");n=s(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:s});var i=n&&n.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);i&&(r.p=i[1])}},"3a68":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e=!0){if(this.m_sysEnabled=!1,this.m_sysEnabled="undefined"!==typeof ThreadCore,e){if(!this.m_sysEnabled)throw Error("Can not find ThreadCore module !!!");ThreadCore.initializeExternModule(this)}}receiveData(e){}postMessageToThread(e,t=null){this.m_sysEnabled&&(null!=t?ThreadCore.postMessageToThread(e):ThreadCore.postMessageToThread(e,t))}getTaskClass(){throw Error("the taskClass value is illegal !!!")}dependencyFinish(){}getUniqueName(){throw Error("the uniqueName value is illegal !!!")}}t.BaseTaskInThread=n},6155:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("3a68"),s=r("eec2");class i extends n.BaseTaskInThread{constructor(){super()}parseFromStr(e,t){let r=[],n=new s.ObjDataParser,i=null,o=[];try{i=n.Parse(t)}catch(l){}if(null!=i){let e=i.length;for(let t=0;t<e;++t){const e=i[t],n=e.geometry,s=this.createModel(n);if(s.uuid=e.name,null!=s.vertices){o.push(s.indices),o.push(s.vertices),o.push(s.normals);for(let e=0,t=s.uvsList.length;e<t;++e)o.push(s.uvsList[e])}r.push(s)}}let a={models:r};e.data=a,o.length>0?this.postMessageToThread(e,o):this.postMessageToThread(e)}createModel(e){let t=e.vertices.length,r=t/3;if(r>=3){let t=null;if(null==t){t=r<=65535?new Uint16Array(r):new Uint32Array(r);for(let e=0;e<r;++e)t[e]=e}null==e.normals||e.normals;let n={uvsList:[new Float32Array(e.uvs)],vertices:new Float32Array(e.vertices),normals:new Float32Array(e.normals),indices:t};return n}{let e={uvsList:null,vertices:null,normals:null,indices:null};return e}}receiveData(e){let t=e.streams[0];const r=new FileReader;r.onload=t=>{this.parseFromStr(e,r.result)},r.readAsText(new Blob([t]))}}t.ModuleOBJGeomParser=i;new i},8875:function(e,t,r){var n,s,i;(function(r,o){s=[],n=o,i="function"===typeof n?n.apply(t,s):n,void 0===i||(e.exports=i)})("undefined"!==typeof self&&self,(function(){function e(){var t=Object.getOwnPropertyDescriptor(document,"currentScript");if(!t&&"currentScript"in document&&document.currentScript)return document.currentScript;if(t&&t.get!==e&&document.currentScript)return document.currentScript;try{throw new Error}catch(f){var r,n,s,i=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,o=/@([^@]*):(\d+):(\d+)\s*$/gi,a=i.exec(f.stack)||o.exec(f.stack),l=a&&a[1]||!1,u=a&&a[2]||!1,c=document.location.href.replace(document.location.hash,""),h=document.getElementsByTagName("script");l===c&&(r=document.documentElement.outerHTML,n=new RegExp("(?:[^\\n]+?\\n){0,"+(u-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),s=r.replace(n,"$1").trim());for(var d=0;d<h.length;d++){if("interactive"===h[d].readyState)return h[d];if(h[d].src===l)return h[d];if(l===c&&h[d].innerHTML&&h[d].innerHTML.trim()===s)return h[d]}return null}}return e}))},eec2:function(e,t,r){"use strict";function n(){var e=/^[og]\s*(.+)?/,t=/^mtllib /,r=/^usemtl /,n=/^usemap /;function s(){var e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);var r=this.object&&"function"===typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(e,t){var r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);var n={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==r?r.smooth:this.smooth,groupStart:void 0!==r?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){var t={index:"number"===typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(n),n},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(var r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},r&&r.name&&"function"===typeof r.clone){var n=r.clone(0);n.inherited=!0,this.object.materials.push(n)}this.objects.push(this.object)},finalize:function(){this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseNormalIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseUVIndex:function(e,t){var r=parseInt(e,10);return 2*(r>=0?r-1:r+t/2)},addVertex:function(e,t,r){var n=this.vertices,s=this.object.geometry.vertices;s.push(n[e+0],n[e+1],n[e+2]),s.push(n[t+0],n[t+1],n[t+2]),s.push(n[r+0],n[r+1],n[r+2])},addVertexPoint:function(e){var t=this.vertices,r=this.object.geometry.vertices;r.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){var t=this.vertices,r=this.object.geometry.vertices;r.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,r){var n=this.normals,s=this.object.geometry.normals;s.push(n[e+0],n[e+1],n[e+2]),s.push(n[t+0],n[t+1],n[t+2]),s.push(n[r+0],n[r+1],n[r+2])},addColor:function(e,t,r){var n=this.colors,s=this.object.geometry.colors;s.push(n[e+0],n[e+1],n[e+2]),s.push(n[t+0],n[t+1],n[t+2]),s.push(n[r+0],n[r+1],n[r+2])},addUV:function(e,t,r){var n=this.uvs,s=this.object.geometry.uvs;s.push(n[e+0],n[e+1]),s.push(n[t+0],n[t+1]),s.push(n[r+0],n[r+1])},addUVLine:function(e){var t=this.uvs,r=this.object.geometry.uvs;r.push(t[e+0],t[e+1])},addFace:function(e,t,r,n,s,i,o,a,l){var u=this.vertices.length,c=this.parseVertexIndex(e,u),h=this.parseVertexIndex(t,u),d=this.parseVertexIndex(r,u);if(this.addVertex(c,h,d),this.colors.length>0&&this.addColor(c,h,d),void 0!==n&&""!==n){var f=this.uvs.length;c=this.parseUVIndex(n,f),h=this.parseUVIndex(s,f),d=this.parseUVIndex(i,f),this.addUV(c,h,d)}if(void 0!==o&&""!==o){var p=this.normals.length;c=this.parseNormalIndex(o,p),h=o===a?c:this.parseNormalIndex(a,p),d=o===l?c:this.parseNormalIndex(l,p),this.addNormal(c,h,d)}},addPointGeometry:function(e){this.object.geometry.type="Points";for(var t=this.vertices.length,r=0,n=e.length;r<n;r++)this.addVertexPoint(this.parseVertexIndex(e[r],t))},addLineGeometry:function(e,t){this.object.geometry.type="Line";for(var r=this.vertices.length,n=this.uvs.length,s=0,i=e.length;s<i;s++)this.addVertexLine(this.parseVertexIndex(e[s],r));var o=0;for(i=t.length;o<i;o++)this.addUVLine(this.parseUVIndex(t[o],n))}};return e.startObject("",!1),e}this.Parse=function(i){var o=new s;-1!==i.indexOf("\r\n")&&(i=i.replace(/\r\n/g,"\n")),-1!==i.indexOf("\\\n")&&(i=i.replace(/\\\n/g,""));for(var a=i.split("\n"),l="",u="",c=0,h=[],d="function"===typeof"".trimLeft,f=0,p=a.length;f<p;f++)if(l=a[f],l=d?l.trimLeft():l.trim(),c=l.length,0!==c&&(u=l.charAt(0),"#"!==u))if("v"===u){var m=l.split(/\s+/);switch(m[0]){case"v":o.vertices.push(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3])),m.length>=7&&o.colors.push(parseFloat(m[4]),parseFloat(m[5]),parseFloat(m[6]));break;case"vn":o.normals.push(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3]));break;case"vt":o.uvs.push(parseFloat(m[1]),parseFloat(m[2]));break}}else if("f"===u){for(var v=l.substr(1).trim(),g=v.split(/\s+/),b=[],y=0,j=g.length;y<j;y++){var x=g[y];if(x.length>0){var M=x.split("/");b.push(M)}}var T=b[0];for(y=1,j=b.length-1;y<j;y++){var w=b[y],O=b[y+1];o.addFace(T[0],w[0],O[0],T[1],w[1],O[1],T[2],w[2],O[2])}}else if("l"===u){var P=l.substring(1).trim().split(" "),V=[],F=[];if(-1===l.indexOf("/"))V=P;else for(var I=0,L=P.length;I<L;I++){var S=P[I].split("/");""!==S[0]&&V.push(S[0]),""!==S[1]&&F.push(S[1])}o.addLineGeometry(V,F)}else if("p"===u){v=l.substr(1).trim();var _=v.split(" ");o.addPointGeometry(_)}else if(null!==(h=e.exec(l))){var E=(" "+h[0].substr(1).trim()).substr(1);o.startObject(E)}else if(r.test(l))o.object.startMaterial(l.substring(7).trim(),o.materialLibraries);else if(t.test(l))o.materialLibraries.push(l.substring(7).trim());else if(n.test(l));else if("s"===u){if(h=l.split(" "),h.length>1){var C=h[1].trim().toLowerCase();o.object.smooth="0"!==C&&"off"!==C}else o.object.smooth=!0;var U=o.object.currentMaterial();U&&(U.smooth=o.object.smooth)}else if("\0"===l)continue;return o.finalize(),o.objects}}r.r(t),r.d(t,"ObjDataParser",(function(){return n}))},fae3:function(e,t,r){"use strict";r.r(t);r("1eb2");var n=r("6155");for(var s in n)["default"].indexOf(s)<0&&function(e){r.d(t,e,(function(){return n[e]}))}(s)}})}));